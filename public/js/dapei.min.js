$(function(){function d(e){var t='<div class="itemDragContainer"><img class="" src="'+e.img+'" /></div>',n="dragItemId"+c,r="#"+n;$(t).appendTo(i).attr("id",n),new NAVY.Resize(r),p.push(new NAVY.Drag(r,r,{left:e.left,top:e.top})),c++}var e,t,n,r,i=$("#dragWrapper"),s=i.offset(),o=$("body"),u={width:i.width(),height:i.height()},a={pageX:u.width+s.left,pageY:u.height+s.top},f=150,l=150,c=1,h=5,p=[];e=!1,t={},n=null,r={},$("#floatRight").on("mousedown",".dragItem",function(f){var l,c=$(this);return c.hasClass("dragItem")&&(e=!0,u.height=i.height(),a.pageY=u.height+s.top,t.img=c.find("img").attr("src"),l=c.offset(),r.left=f.pageX-l.left,r.top=f.pageY-l.top,n=c.clone().css({cursor:"pointer",position:"absolute",left:l.left,top:l.top}).attr("id","tempItemDrag").appendTo(o)),!1}),$(document).mouseup(function(i){var o,c,p,v,m,g;if(e)return o=i.pageX,c=i.pageY,o>s.left-f&&o<a.pageX&&c>s.top-l&&c<a.pageY&&(p=o-s.left-r.left,v=c-s.top-r.top,m=u.width-f-h,g=u.height-l-h,p=Math.min(m,Math.max(p,h)),v=Math.min(g,Math.max(v,h)),t.left=p,t.top=v,d(t)),n.length&&n.remove(),e=!1,!1}).mousemove(function(t){e&&n.length&&n.css({left:t.pageX-r.left,top:t.pageY-r.top})}),$("#save").click(function(){var e=p.length,t=0;for(t=0;t<e;t++)p[t].setCursorDefault();$("#tempWrapper").html($("#dragWrapper").clone());for(t=0;t<e;t++)p[t].setCursorMove()})})